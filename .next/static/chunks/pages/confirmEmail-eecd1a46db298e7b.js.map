{"version":3,"file":"static/chunks/pages/confirmEmail-eecd1a46db298e7b.js","mappings":"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","sources":["webpack://_N_E/./node_modules/@styled-icons/boxicons-regular/Support/Support.esm.js","webpack://_N_E/./node_modules/@styled-icons/fa-solid/Redo/Redo.esm.js","webpack://_N_E/./node_modules/@styled-icons/material/Email/Email.esm.js","webpack://_N_E/./pages/confirmEmail.js","webpack://_N_E/?162e"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Support = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12 2C6.486 2 2 6.486 2 12v4.143C2 17.167 2.897 18 4 18h1a1 1 0 0 0 1-1v-5.143a1 1 0 0 0-1-1h-.908C4.648 6.987 7.978 4 12 4s7.352 2.987 7.908 6.857H19a1 1 0 0 0-1 1V18c0 1.103-.897 2-2 2h-2v-1h-4v3h6c2.206 0 4-1.794 4-4 1.103 0 2-.833 2-1.857V12c0-5.514-4.486-10-10-10z\"\n  }));\n});\nSupport.displayName = 'Support';\nexport var SupportDimensions = {\n  height: 24,\n  width: 24\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Redo = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 512 512\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M386.3 160H336c-17.7 0-32 14.3-32 32s14.3 32 32 32h128c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32s-32 14.3-32 32v51.2l-17.6-17.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8 229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3 163.8-62.5 226.3 0l17.2 17.2z\"\n  }));\n});\nRedo.displayName = 'Redo';\nexport var RedoDimensions = {\n  height: 512,\n  width: 512\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Email = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z\"\n  }));\n});\nEmail.displayName = 'Email';\nexport var EmailDimensions = {\n  height: 24,\n  width: 24\n};","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { graphql } from '@apollo/client/react/hoc';\nimport { Email } from '@styled-icons/material/Email';\nimport { get } from 'lodash';\nimport { FormattedMessage } from 'react-intl';\n\nimport { gqlV1 } from '../lib/graphql/helpers';\n\nimport Container from '../components/Container';\nimport { Box } from '../components/Grid';\nimport MessageBox from '../components/MessageBox';\nimport Page from '../components/Page';\nimport { withUser } from '../components/UserProvider';\n\nclass ConfirmEmailPage extends React.Component {\n  static getInitialProps({ query }) {\n    return { token: query.token };\n  }\n\n  static propTypes = {\n    /** Token to validate, given in URL */\n    token: PropTypes.string.isRequired,\n    // from graphql\n    confirmUserEmail: PropTypes.func.isRequired,\n    // from withUser\n    loadingLoggedInUser: PropTypes.bool.isRequired,\n    // from withUser\n    refetchLoggedInUser: PropTypes.func.isRequired,\n  };\n\n  state = { status: 'submitting', error: null, validationTriggered: false };\n\n  componentDidMount() {\n    if (!this.props.loadingLoggedInUser) {\n      return this.triggerEmailValidation();\n    }\n  }\n\n  componentDidUpdate() {\n    if (!this.state.validationTriggered && !this.props.loadingLoggedInUser) {\n      return this.triggerEmailValidation();\n    }\n  }\n\n  /**\n   * The reason for the logic around the trigger of this function is that `refetchLoggedInUser`\n   * will not be effective if user is already loading (Apollo discards duplicate queries).\n   */\n  async triggerEmailValidation() {\n    try {\n      this.setState({ validationTriggered: true });\n      await this.props.confirmUserEmail({ variables: { token: this.props.token } });\n      setTimeout(this.props.refetchLoggedInUser, 3000);\n      this.setState({ status: 'success' });\n    } catch (e) {\n      const error = get(e, 'graphQLErrors.0') || e;\n      this.setState({ status: 'error', error: error });\n    }\n  }\n\n  getIconColor(status) {\n    if (status === 'submitting') {\n      return '#3385FF';\n    } else if (status === 'error') {\n      return '#CC1836';\n    } else {\n      return '#00A34C';\n    }\n  }\n\n  render() {\n    const { status, error } = this.state;\n\n    return (\n      <Page title=\"Email confirmation\">\n        <Container\n          display=\"flex\"\n          py={[5, 6]}\n          px={2}\n          flexDirection=\"column\"\n          alignItems=\"center\"\n          background=\"linear-gradient(180deg, #EBF4FF, #FFFFFF)\"\n        >\n          <Box my={3}>\n            <Email size={42} color={this.getIconColor(status)} />\n          </Box>\n          {status === 'submitting' && (\n            <MessageBox type=\"info\" isLoading>\n              <FormattedMessage id=\"confirmEmail.validating\" defaultMessage=\"Validating your email address...\" />\n            </MessageBox>\n          )}\n          {status === 'success' && (\n            <MessageBox mb={3} type=\"success\" withIcon>\n              <FormattedMessage id=\"confirmEmail.sucess\" defaultMessage=\"Your email has been changed\" />\n            </MessageBox>\n          )}\n          {status === 'error' && (\n            <MessageBox type=\"error\" withIcon>\n              {error.extensions?.code === 'INVALID_TOKEN' ? (\n                <FormattedMessage\n                  id=\"confirmEmail.error.InvalidToken\"\n                  defaultMessage=\"The confirmation link is invalid or has expired\"\n                />\n              ) : (\n                error.message\n              )}\n            </MessageBox>\n          )}\n        </Container>\n      </Page>\n    );\n  }\n}\n\nconst confirmUserEmailMutation = gqlV1/* GraphQL */ `\n  mutation ConfirmUserEmail($token: String!) {\n    confirmUserEmail(token: $token) {\n      id\n      email\n      emailWaitingForValidation\n    }\n  }\n`;\n\nexport const addConfirmUserEmailMutation = graphql(confirmUserEmailMutation, {\n  name: 'confirmUserEmail',\n});\n\nexport default withUser(addConfirmUserEmailMutation(ConfirmEmailPage));\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/confirmEmail\",\n      function () {\n        return require(\"private-next-pages/confirmEmail.js\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/confirmEmail\"])\n      });\n    }\n  "],"names":["React","graphql","Email","FormattedMessage","gqlV1","Container","Box","MessageBox","Page","withUser","ConfirmEmailPage","status","error","validationTriggered","props","loadingLoggedInUser","triggerEmailValidation","state","setState","confirmUserEmail","variables","token","setTimeout","refetchLoggedInUser","getIconColor","extensions","code","message","query","Component","confirmUserEmailMutation","addConfirmUserEmailMutation","name"],"sourceRoot":""}