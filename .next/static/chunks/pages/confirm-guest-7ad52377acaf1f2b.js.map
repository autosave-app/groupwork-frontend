{"version":3,"file":"static/chunks/pages/confirm-guest-7ad52377acaf1f2b.js","mappings":"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","sources":["webpack://_N_E/./node_modules/@styled-icons/boxicons-regular/Support/Support.esm.js","webpack://_N_E/./node_modules/@styled-icons/fa-solid/Redo/Redo.esm.js","webpack://_N_E/./node_modules/@styled-icons/material/Email/Email.esm.js","webpack://_N_E/./node_modules/lodash/uniq.js","webpack://_N_E/./components/MessageBoxGraphqlError.js","webpack://_N_E/./lib/guest-accounts.js","webpack://_N_E/./pages/confirm-guest.js","webpack://_N_E/?4e3e"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Support = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12 2C6.486 2 2 6.486 2 12v4.143C2 17.167 2.897 18 4 18h1a1 1 0 0 0 1-1v-5.143a1 1 0 0 0-1-1h-.908C4.648 6.987 7.978 4 12 4s7.352 2.987 7.908 6.857H19a1 1 0 0 0-1 1V18c0 1.103-.897 2-2 2h-2v-1h-4v3h6c2.206 0 4-1.794 4-4 1.103 0 2-.833 2-1.857V12c0-5.514-4.486-10-10-10z\"\n  }));\n});\nSupport.displayName = 'Support';\nexport var SupportDimensions = {\n  height: 24,\n  width: 24\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Redo = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 512 512\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M386.3 160H336c-17.7 0-32 14.3-32 32s14.3 32 32 32h128c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32s-32 14.3-32 32v51.2l-17.6-17.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8 229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3 163.8-62.5 226.3 0l17.2 17.2z\"\n  }));\n});\nRedo.displayName = 'Redo';\nexport var RedoDimensions = {\n  height: 512,\n  width: 512\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Email = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4-8 5-8-5V6l8 5 8-5v2z\"\n  }));\n});\nEmail.displayName = 'Email';\nexport var EmailDimensions = {\n  height: 24,\n  width: 24\n};","var baseUniq = require('./_baseUniq');\n\n/**\n * Creates a duplicate-free version of an array, using\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons, in which only the first occurrence of each element\n * is kept. The order of result values is determined by the order they occur\n * in the array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @returns {Array} Returns the new duplicate free array.\n * @example\n *\n * _.uniq([2, 1, 2]);\n * // => [2, 1]\n */\nfunction uniq(array) {\n  return (array && array.length) ? baseUniq(array) : [];\n}\n\nmodule.exports = uniq;\n","import React from 'react';\nimport PropTypes from 'prop-types';\nimport { useIntl } from 'react-intl';\n\nimport { formatErrorMessage, getErrorFromGraphqlException } from '../lib/errors';\n\nimport MessageBox from './MessageBox';\n\n/**\n * A `MessageBox` specialized to display GraphQL errors.\n * Accepts all props from `MessageBox`.\n */\nconst MessageBoxGraphqlError = ({ error, ...props }) => {\n  const intl = useIntl();\n  return (\n    <MessageBox type=\"error\" withIcon {...props}>\n      {formatErrorMessage(intl, getErrorFromGraphqlException(error))}\n    </MessageBox>\n  );\n};\n\nMessageBoxGraphqlError.propTypes = {\n  error: PropTypes.any,\n};\n\nexport default MessageBoxGraphqlError;\n","import { omitBy, uniq } from 'lodash';\n\nimport { getFromLocalStorage, LOCAL_STORAGE_KEYS, setLocalStorage } from './local-storage';\n\n/**\n * Returns a map like { [email]: token }\n */\nconst getAllGuestTokens = () => {\n  try {\n    const localStorageValue = getFromLocalStorage(LOCAL_STORAGE_KEYS.GUEST_TOKENS);\n    return JSON.parse(localStorageValue) || {};\n  } catch (e) {\n    return {};\n  }\n};\n\nconst normalizeGuestToken = (key, value) => {\n  if (typeof value === 'string') {\n    return { email: key, token: value };\n  } else {\n    return { email: value.email, token: value.email, orderId: key };\n  }\n};\n\nconst normalizeEmailForGuestToken = email => {\n  return email.trim().toLowerCase();\n};\n\n/**\n * Returns all emails that were used to contribute as guest on this browser\n */\nexport const getAllGuestEmails = () => {\n  const guestTokens = getAllGuestTokens();\n  const normalizedEntries = Object.entries(guestTokens).map(([key, value]) => normalizeGuestToken(key, value));\n  const emails = normalizedEntries.map(e => e.email);\n  return uniq(emails);\n};\n\nexport const removeGuestTokens = (emails = [], tokens = []) => {\n  const allTokens = getAllGuestTokens();\n  const normalizedEmails = emails?.map(normalizeEmailForGuestToken);\n  const newTokens = omitBy(allTokens, (value, key) => {\n    const { email, token } = normalizeGuestToken(key, value);\n    if (normalizedEmails && normalizedEmails.includes(email)) {\n      return true;\n    } else if (tokens && tokens.includes(token)) {\n      return true;\n    } else {\n      return false;\n    }\n  });\n\n  setLocalStorage(LOCAL_STORAGE_KEYS.GUEST_TOKENS, JSON.stringify(newTokens));\n};\n\nexport const setGuestToken = (email, orderId, token) => {\n  const tokens = { ...getAllGuestTokens(), [orderId]: { token, email: normalizeEmailForGuestToken(email) } };\n  setLocalStorage(LOCAL_STORAGE_KEYS.GUEST_TOKENS, JSON.stringify(tokens));\n};\n","import React, { Fragment } from 'react';\nimport { gql, useMutation } from '@apollo/client';\nimport { Email } from '@styled-icons/material/Email';\nimport { useRouter } from 'next/router';\nimport { defineMessages, FormattedMessage, useIntl } from 'react-intl';\nimport { useTheme } from 'styled-components';\n\nimport { API_V2_CONTEXT } from '../lib/graphql/helpers';\nimport { removeGuestTokens } from '../lib/guest-accounts';\nimport useLoggedInUser from '../lib/hooks/useLoggedInUser';\n\nimport Container from '../components/Container';\nimport { Box } from '../components/Grid';\nimport { getI18nLink } from '../components/I18nFormatters';\nimport Link from '../components/Link';\nimport MessageBox from '../components/MessageBox';\nimport MessageBoxGraphqlError from '../components/MessageBoxGraphqlError';\nimport Page from '../components/Page';\nimport StyledSpinner from '../components/StyledSpinner';\nimport { P } from '../components/Text';\n\nconst STATUS = {\n  SUBMITTING: 'SUBMITTING',\n  SUCCESS: 'SUCCESS',\n  ERROR: 'ERROR',\n};\n\nconst confirmGuestAccountMutation = gql`\n  mutation ConfirmGuestAccount($email: EmailAddress!, $token: String!) {\n    confirmGuestAccount(email: $email, emailConfirmationToken: $token) {\n      accessToken\n      account {\n        id\n        slug\n        name\n      }\n    }\n  }\n`;\n\nconst MESSAGES = defineMessages({\n  pageTitle: {\n    id: 'confirmGuest.title',\n    defaultMessage: 'Account verification',\n  },\n});\n\nconst MUTATION_OPTS = { context: API_V2_CONTEXT };\n\nconst ConfirmGuestPage = () => {\n  const intl = useIntl();\n  const theme = useTheme();\n  const router = useRouter();\n  const { login } = useLoggedInUser();\n  const [status, setStatus] = React.useState(STATUS.SUBMITTING);\n  const [callConfirmGuestAccount, { error, data }] = useMutation(confirmGuestAccountMutation, MUTATION_OPTS);\n  const { token, email } = router.query;\n\n  const confirmGuestAccount = async () => {\n    try {\n      const response = await callConfirmGuestAccount({ variables: { email, token } });\n      const { accessToken, account } = response.data.confirmGuestAccount;\n      removeGuestTokens([email]);\n      setStatus(STATUS.SUCCESS);\n      await login(accessToken);\n      router.push(`/${account.slug}`);\n    } catch {\n      setStatus(STATUS.ERROR);\n    }\n  };\n\n  // Auto-submit on mount, or switch to \"Pick profile\"\n  React.useEffect(() => {\n    if (!email) {\n      setStatus(STATUS.ERROR);\n    } else {\n      // Directly submit the confirmation\n      setStatus(STATUS.SUBMITTING);\n      confirmGuestAccount();\n    }\n  }, []);\n\n  return (\n    <Page title={intl.formatMessage(MESSAGES.pageTitle)}>\n      <Container\n        display=\"flex\"\n        py={[5, 6, 150]}\n        px={2}\n        flexDirection=\"column\"\n        alignItems=\"center\"\n        background=\"linear-gradient(180deg, #EBF4FF, #FFFFFF)\"\n      >\n        {status === STATUS.SUBMITTING && (\n          <Fragment>\n            <Box my={3}>\n              <Email size={42} color={theme.colors.primary[500]} />\n            </Box>\n            <MessageBox type=\"info\" isLoading>\n              <FormattedMessage id=\"confirmEmail.validating\" defaultMessage=\"Validating your email address...\" />\n            </MessageBox>\n          </Fragment>\n        )}\n        {status === STATUS.SUCCESS && (\n          <Fragment>\n            <Container mb={3} pb={3} px={4} textAlign=\"center\" boxShadow=\"0px 8px 8px -10px rgb(146 146 146 / 40%)\">\n              <Box my={3}>\n                <Email size={42} color={theme.colors.green[500]} />\n              </Box>\n              <strong>\n                <FormattedMessage id=\"confirmEmail.success\" defaultMessage=\"Your email has been confirmed\" />\n              </strong>\n            </Container>\n            <Container textAlign=\"center\" p={2}>\n              <Box my={2}>\n                <StyledSpinner size={32} />\n              </Box>\n              {data?.confirmGuestAccount?.account && (\n                <P fontSize=\"13px\" lineHeight=\"18px\" textAlign=\"center\">\n                  <FormattedMessage id=\"confirmGuest.redirecting\" defaultMessage=\"Redirecting to your profile...\" />\n                  <br />\n                  <FormattedMessage\n                    id=\"confirmGuest.dontWait\"\n                    defaultMessage=\"If you don't wish to wait, click <Link>here</Link>.\"\n                    values={{\n                      Link: getI18nLink({\n                        as: Link,\n                        href: `/${data.confirmGuestAccount?.account.slug}`,\n                      }),\n                    }}\n                  />\n                </P>\n              )}\n            </Container>\n          </Fragment>\n        )}\n        {status === STATUS.ERROR && (\n          <Fragment>\n            <Box my={3}>\n              <Email size={42} color={theme.colors.red[500]} />\n            </Box>\n            <MessageBoxGraphqlError error={error} />\n          </Fragment>\n        )}\n      </Container>\n    </Page>\n  );\n};\n\nConfirmGuestPage.getInitialProps = ({ req: { query } }) => {\n  return { token: query.token, email: query.email };\n};\n\nexport default ConfirmGuestPage;\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/confirm-guest\",\n      function () {\n        return require(\"private-next-pages/confirm-guest.js\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/confirm-guest\"])\n      });\n    }\n  "],"names":["React","useIntl","formatErrorMessage","getErrorFromGraphqlException","MessageBox","MessageBoxGraphqlError","error","props","intl","getFromLocalStorage","LOCAL_STORAGE_KEYS","setLocalStorage","getAllGuestTokens","localStorageValue","GUEST_TOKENS","JSON","parse","e","normalizeGuestToken","key","value","email","token","orderId","normalizeEmailForGuestToken","trim","toLowerCase","getAllGuestEmails","guestTokens","normalizedEntries","Object","entries","map","emails","removeGuestTokens","tokens","allTokens","normalizedEmails","newTokens","includes","stringify","setGuestToken","Fragment","gql","useMutation","Email","useRouter","defineMessages","FormattedMessage","useTheme","API_V2_CONTEXT","useLoggedInUser","Container","Box","getI18nLink","Link","Page","StyledSpinner","P","STATUS","SUBMITTING","SUCCESS","ERROR","confirmGuestAccountMutation","MESSAGES","pageTitle","id","defaultMessage","MUTATION_OPTS","context","ConfirmGuestPage","theme","router","login","useState","status","setStatus","callConfirmGuestAccount","data","query","confirmGuestAccount","variables","response","accessToken","account","push","slug","useEffect","formatMessage","colors","primary","green","as","href","red","getInitialProps","req"],"sourceRoot":""}