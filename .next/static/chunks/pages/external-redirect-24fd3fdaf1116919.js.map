{"version":3,"file":"static/chunks/pages/external-redirect-24fd3fdaf1116919.js","mappings":"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","sources":["webpack://_N_E/./node_modules/@styled-icons/boxicons-regular/Support/Support.esm.js","webpack://_N_E/./node_modules/@styled-icons/fa-solid/Redo/Redo.esm.js","webpack://_N_E/./components/StyledCard.tsx","webpack://_N_E/./pages/external-redirect.js","webpack://_N_E/?35aa"],"sourcesContent":["import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Support = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 24 24\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    d: \"M12 2C6.486 2 2 6.486 2 12v4.143C2 17.167 2.897 18 4 18h1a1 1 0 0 0 1-1v-5.143a1 1 0 0 0-1-1h-.908C4.648 6.987 7.978 4 12 4s7.352 2.987 7.908 6.857H19a1 1 0 0 0-1 1V18c0 1.103-.897 2-2 2h-2v-1h-4v3h6c2.206 0 4-1.794 4-4 1.103 0 2-.833 2-1.857V12c0-5.514-4.486-10-10-10z\"\n  }));\n});\nSupport.displayName = 'Support';\nexport var SupportDimensions = {\n  height: 24,\n  width: 24\n};","import _extends from \"@babel/runtime/helpers/extends\";\nimport * as React from 'react';\nimport { StyledIconBase } from '@styled-icons/styled-icon';\nexport var Redo = /*#__PURE__*/React.forwardRef(function (props, ref) {\n  var attrs = {\n    \"fill\": \"currentColor\",\n    \"xmlns\": \"http://www.w3.org/2000/svg\"\n  };\n  return /*#__PURE__*/React.createElement(StyledIconBase, _extends({\n    iconAttrs: attrs,\n    iconVerticalAlign: \"middle\",\n    iconViewBox: \"0 0 512 512\"\n  }, props, {\n    ref: ref\n  }), /*#__PURE__*/React.createElement(\"path\", {\n    fill: \"currentColor\",\n    d: \"M386.3 160H336c-17.7 0-32 14.3-32 32s14.3 32 32 32h128c17.7 0 32-14.3 32-32V64c0-17.7-14.3-32-32-32s-32 14.3-32 32v51.2l-17.6-17.6c-87.5-87.5-229.3-87.5-316.8 0s-87.5 229.3 0 316.8 229.3 87.5 316.8 0c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0c-62.5 62.5-163.8 62.5-226.3 0s-62.5-163.8 0-226.3 163.8-62.5 226.3 0l17.2 17.2z\"\n  }));\n});\nRedo.displayName = 'Redo';\nexport var RedoDimensions = {\n  height: 512,\n  width: 512\n};","import React from 'react';\nimport styledPropTypes from '@styled-system/prop-types';\nimport styled from 'styled-components';\nimport {\n  background,\n  BackgroundProps,\n  border,\n  BorderProps,\n  color,\n  ColorProps,\n  compose,\n  flexbox,\n  FlexboxProps,\n  layout,\n  LayoutProps,\n  position,\n  PositionProps,\n  shadow,\n  ShadowProps,\n  space,\n  SpaceProps,\n  typography,\n  TypographyProps,\n} from 'styled-system';\n\ntype StyledCardProps = BackgroundProps &\n  BorderProps &\n  FlexboxProps &\n  LayoutProps &\n  PositionProps &\n  SpaceProps &\n  TypographyProps &\n  ShadowProps &\n  ColorProps &\n  React.HTMLProps<HTMLDivElement>;\n\n/**\n * A simple styled-component to contain content in a card UI using styled-system.\n *\n * @see See [styled-system docs](https://github.com/jxnblk/styled-system/blob/master/docs/api.md) for usage of those props\n */\nconst StyledCard = styled.div<StyledCardProps>(\n  compose(flexbox, typography, background, border, shadow, color, layout, position, space),\n);\n\nStyledCard.propTypes = {\n  ...styledPropTypes.flexbox,\n  ...styledPropTypes.typography,\n  ...styledPropTypes.background,\n  ...styledPropTypes.border,\n  ...styledPropTypes.shadow,\n  ...styledPropTypes.color,\n  ...styledPropTypes.layout,\n  ...styledPropTypes.space,\n  ...styledPropTypes.position,\n};\n\nStyledCard.defaultProps = {\n  bg: 'white.full',\n  borderWidth: '1px',\n  borderStyle: 'solid',\n  borderColor: 'black.300',\n  borderRadius: '8px',\n  overflowX: 'hidden',\n  overflowY: 'hidden',\n};\n\n/** @component */\nexport default StyledCard;\n","import React from 'react';\nimport { ExclamationTriangle } from '@styled-icons/fa-solid/ExclamationTriangle';\nimport { useRouter } from 'next/router';\nimport { FormattedMessage } from 'react-intl';\nimport { isURL } from 'validator';\n\nimport { isRelativeHref, isTrustedRedirectHost } from '../lib/url-helpers';\nimport { isValidRelativeUrl, parseToBoolean } from '../lib/utils';\n\nimport Container from '../components/Container';\nimport { Flex } from '../components/Grid';\nimport Link from '../components/Link';\nimport Loading from '../components/Loading';\nimport Page from '../components/Page';\nimport StyledButton from '../components/StyledButton';\nimport StyledCard from '../components/StyledCard';\nimport StyledHr from '../components/StyledHr';\nimport { H3, P, Span, Strong } from '../components/Text';\n\n// Make sure fallback is an internal link\nconst getFallback = fallback => {\n  if (!fallback || !isRelativeHref(fallback)) {\n    return '/';\n  } else {\n    return fallback;\n  }\n};\n\nexport const isValidExternalRedirect = url => {\n  const validationParams = process.env.NODE_ENV === 'production' ? {} : { require_tld: false }; // eslint-disable-line camelcase\n  return url && isURL(url, validationParams);\n};\n\nconst shouldRedirectDirectly = urlStr => {\n  try {\n    const parsedUrl = new URL(urlStr);\n    return isTrustedRedirectHost(parsedUrl.host);\n  } catch {\n    return false;\n  }\n};\n\n/**\n * A page to use whenever you need to redirect to a page that may be external to Open Collective.\n * The page displays a confirmation to make sure that user is aware of being redirected, to prevent\n * phishing attacks.\n */\nconst ExternalRedirectPage = () => {\n  const router = useRouter();\n  const [isReady, setReady] = React.useState(false);\n  const [pendingAction, setPendingAction] = React.useState(false);\n  const query = router?.query || {};\n  const fallback = getFallback(query.fallback);\n  const shouldRedirectParent = parseToBoolean(query.shouldRedirectParent);\n\n  React.useEffect(() => {\n    if (router && !query.url) {\n      router.push(fallback);\n    } else if (isValidRelativeUrl(query.url)) {\n      router.push(query.url);\n    } else if (!isValidExternalRedirect(query.url)) {\n      router.push(fallback);\n    } else if (shouldRedirectDirectly(query.url)) {\n      if (shouldRedirectParent) {\n        window.parent.location.href = query.url;\n      } else {\n        router.push(query.url);\n      }\n    } else {\n      setReady(true);\n    }\n  }, [router, query.url]);\n\n  return (\n    <Page>\n      <Flex justifyContent=\"center\" alignItems=\"center\" py={[4, 5, 6]}>\n        {isReady ? (\n          <StyledCard maxWidth={450}>\n            <Container p={3}>\n              <H3 fontSize=\"16px\" lineHeight=\"15px\" fontWeight=\"bold\" my={2}>\n                <ExclamationTriangle data-type=\"message-icon\" size=\"1em\" color=\"#CCCC18\" />\n                <Span ml={2} css={{ verticalAlign: 'middle' }}>\n                  <FormattedMessage id=\"PleaseBeCareful\" defaultMessage=\"Please be careful\" />\n                </Span>\n              </H3>\n              <StyledHr my={2} borderColor=\"black.300\" />\n              <P fontSize=\"14px\" lineHeight=\"20px\" my={3}>\n                <FormattedMessage\n                  id=\"externalRedirect.message\"\n                  defaultMessage=\"Your request is currently being redirected to {redirect}. For the safety and privacy of your Open Collective account, remember to never enter your credentials unless you're on the real Open Collective website.\"\n                  values={{ redirect: <Strong wordBreak=\"break-all\">{query.url}</Strong> }}\n                />\n              </P>\n            </Container>\n            <Container display=\"flex\" justifyContent=\"flex-end\" backgroundColor=\"black.100\" p={1}>\n              <a\n                href={query.url}\n                onClick={e => {\n                  setPendingAction('REDIRECT');\n                  if (shouldRedirectParent) {\n                    e.preventDefault();\n                    window.parent.location.href = query.url;\n                  }\n                }}\n              >\n                <StyledButton\n                  buttonSize=\"small\"\n                  my={2}\n                  minWidth={140}\n                  buttonStyle=\"primary\"\n                  loading={pendingAction === 'REDIRECT'}\n                  disabled={pendingAction}\n                >\n                  <FormattedMessage id=\"actions.continue\" defaultMessage=\"Continue\" />\n                </StyledButton>\n              </a>\n              <Link href={fallback} onClick={() => setPendingAction('CANCEL')}>\n                <StyledButton\n                  buttonSize=\"small\"\n                  m={2}\n                  minWidth={140}\n                  data-cy=\"confirmation-modal-cancel\"\n                  loading={pendingAction === 'CANCEL'}\n                  disabled={pendingAction}\n                >\n                  <FormattedMessage id=\"actions.cancel\" defaultMessage=\"Cancel\" />\n                </StyledButton>\n              </Link>\n            </Container>\n          </StyledCard>\n        ) : (\n          <Loading />\n        )}\n      </Flex>\n    </Page>\n  );\n};\n\nexport default ExternalRedirectPage;\n","\n    (window.__NEXT_P = window.__NEXT_P || []).push([\n      \"/external-redirect\",\n      function () {\n        return require(\"private-next-pages/external-redirect.js\");\n      }\n    ]);\n    if(module.hot) {\n      module.hot.dispose(function () {\n        window.__NEXT_P.push([\"/external-redirect\"])\n      });\n    }\n  "],"names":["styledPropTypes","styled","background","border","color","compose","flexbox","layout","position","shadow","space","typography","StyledCard","div","propTypes","defaultProps","bg","borderWidth","borderStyle","borderColor","borderRadius","overflowX","overflowY","React","ExclamationTriangle","useRouter","FormattedMessage","isURL","isRelativeHref","isTrustedRedirectHost","isValidRelativeUrl","parseToBoolean","Container","Flex","Link","Loading","Page","StyledButton","StyledHr","H3","P","Span","Strong","getFallback","fallback","isValidExternalRedirect","url","validationParams","require_tld","shouldRedirectDirectly","urlStr","parsedUrl","URL","host","ExternalRedirectPage","router","useState","isReady","setReady","pendingAction","setPendingAction","query","shouldRedirectParent","useEffect","push","window","parent","location","href","redirect","e","preventDefault","verticalAlign"],"sourceRoot":""}